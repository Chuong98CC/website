// Course component system with bilingual support

// Course data structure with all course information
const courseData = {
    candy: {
        id: 'candy',
        icon: 'üç≠',
        iconSize: 'text-xl',
        containerClasses: 'bg-gradient-to-br from-green-200 via-green-300 to-blue-300',
        iconBgClasses: 'bg-gradient-to-br from-green-300 to-blue-400',
        skillColorClass: 'text-pink-600',
        ringColor: 'ring-green-300'
    },
    cookies: {
        id: 'cookies',
        icon: 'üç™',
        iconSize: 'text-2xl',
        containerClasses: 'bg-gradient-to-br from-blue-200 via-blue-300 to-indigo-300',
        iconBgClasses: 'bg-gradient-to-br from-blue-300 to-indigo-400',
        skillColorClass: 'text-orange-600',
        ringColor: 'ring-blue-300'
    },
    donuts: {
        id: 'donuts',
        icon: 'üç©',
        iconSize: 'text-2xl',
        containerClasses: 'bg-gradient-to-br from-indigo-200 via-indigo-300 to-purple-300',
        iconBgClasses: 'bg-gradient-to-br from-indigo-300 to-purple-400',
        skillColorClass: 'text-indigo-600',
        ringColor: 'ring-indigo-300'
    },
    bagels: {
        id: 'bagels',
        icon: 'ü•Ø',
        iconSize: 'text-2xl',
        containerClasses: 'bg-gradient-to-br from-purple-200 via-purple-300 to-pink-300',
        iconBgClasses: 'bg-gradient-to-br from-purple-300 to-pink-400',
        skillColorClass: 'text-teal-600',
        ringColor: 'ring-purple-300'
    },
    burgers: {
        id: 'burgers',
        icon: 'üçî',
        iconSize: 'text-2xl',
        containerClasses: 'bg-gradient-to-br from-pink-200 via-pink-300 to-red-300',
        iconBgClasses: 'bg-gradient-to-br from-pink-300 to-red-400',
        skillColorClass: 'text-red-600',
        ringColor: 'ring-pink-300'
    },
    pizzas: {
        id: 'pizzas',
        icon: 'üçï',
        iconSize: 'text-2xl',
        containerClasses: 'bg-gradient-to-br from-red-200 via-red-300 to-orange-300',
        iconBgClasses: 'bg-gradient-to-br from-red-300 to-orange-400',
        skillColorClass: 'text-cyan-600',
        ringColor: 'ring-red-300'
    },
    intensive: {
        id: 'intensive',
        icon: 'üöÄ',
        iconSize: 'text-2xl',
        containerClasses: 'bg-gradient-to-br from-orange-400 via-orange-500 to-orange-600 text-white',
        iconBgClasses: 'bg-white/10 backdrop-blur-sm',
        skillColorClass: 'text-yellow-300',
        ringColor: 'ring-orange-300',
        isIntensive: true
    }
};

// Course translations
const courseTranslations = {
    en: {
        candy: {
            title: "Level Candy",
            subtitle: "Beginner Level - IELTS Foundation",
            targetLabel: "For:",
            targetDescription: "Not for complete beginners or those with weak foundations. For students who haven't been exposed to IELTS much or have limited English experience.",
            goalLabel: "Goals:",
            goalDescription: "Orientation and introduction to IELTS. Focus on reviewing key grammar points, building basic topic vocabulary, and IELTS vocabulary.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "Get familiar with simple exercises, short passages, practice analysis, and understanding question requirements",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Get familiar with simple questions, focus on idea development, pronunciation and reflexes",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "Practice writing complete sentences, practice idea development. Distinguish between spoken and written language in IELTS",
            targetTitle: "üéØ Target",
            targetBand: "Band 2.5 - Solid foundation for next levels"
        },
        cookies: {
            title: "Level Cookies",
            subtitle: "Elementary Level - IELTS Introduction",
            targetLabel: "For:",
            targetDescription: "Students who have studied IELTS for less than 3 months (entry test score from 3.0+) or students who have completed Level Candy.",
            goalLabel: "Goals:",
            goalDescription: "Students begin to get familiar with IELTS format and become acquainted with different question types across all skills.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "Work on short exercises, focus on passage analysis and vocabulary upgrading",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Practice speaking on familiar daily topics, focus on idea development according to IELTS format",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "Get familiar with writing theory: Task 1 charts and Task 2 question types",
            targetTitle: "üéØ Target",
            targetBand: "Band 3.5 - Clear understanding of IELTS format and approach"
        },
        donuts: {
            title: "Level Donuts",
            subtitle: "Intermediate Level - IELTS Progress",
            targetLabel: "For:",
            targetDescription: "Students who have studied IELTS before (entry test score from 4.0+) or students who have completed Level Cookies.",
            goalLabel: "Requirements:",
            goalDescription: "Students should have basic IELTS knowledge and question types (this level still reviews writing theory).",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "Start working on longer and more challenging exercises, enhance passage analysis skills",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Practice speaking on familiar topics, improve pronunciation and reflexes, enhance B1&B2 vocabulary",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "Practice writing various Task 1 charts and Task 2, enhance analysis and outline planning skills",
            targetTitle: "üéØ Target",
            targetBand: "Band 4.5 - Master basic IELTS skills"
        },
        bagels: {
            title: "Level Bagels",
            subtitle: "Upper Intermediate - IELTS Mastery",
            targetLabel: "For:",
            targetDescription: "Students who have studied IELTS before (entry test score from 4.5+) or students who have completed Level Donuts.",
            goalLabel: "Requirements:",
            goalDescription: "Students should have IELTS foundation and want to improve skills to achieve higher scores.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "Get familiar with longer reading and listening passages, gradually increasing difficulty, enhance academic vocabulary",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Practice with diverse topics, develop logical thinking, improve pronunciation",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "Practice writing in standard format, enhance argumentation skills, use advanced vocabulary",
            targetTitle: "üéØ Target",
            targetBand: "Band 5.0+ - Enhance and refine IELTS skills"
        },
        burgers: {
            title: "Level Burgers",
            subtitle: "Advanced Level - IELTS Excellence",
            targetLabel: "For:",
            targetDescription: "Students who have studied IELTS before (entry test score 5.0+) or students who have completed Level Donuts.",
            goalLabel: "Requirements:",
            goalDescription: "Students should have solid IELTS knowledge and basic test-taking skills across all areas.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "Work on complex passages and recordings, enhance speed and accuracy in all question types",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Practice advanced topics, develop fluency and coherence, master complex grammar structures",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "Master advanced writing techniques, sophisticated vocabulary and complex sentence structures",
            targetTitle: "üéØ Target",
            targetBand: "Band 5.5+ - Advanced IELTS proficiency"
        },
        pizzas: {
            title: "Level Pizzas",
            subtitle: "Expert Level - IELTS Mastery",
            targetLabel: "For:",
            targetDescription: "Students with solid IELTS foundation (entry test score from 6.0+) or students who have completed Level Burgers.",
            goalLabel: "Requirements:",
            goalDescription: "Students should have strong IELTS foundation and want to achieve high band scores for academic or professional purposes.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "Master complex academic texts and recordings, achieve near-native comprehension levels",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Achieve native-like fluency, master advanced discourse markers and sophisticated vocabulary",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "Produce sophisticated academic writing with complex argumentation and advanced linguistic features",
            targetTitle: "üéØ Target",
            targetBand: "Band 6.5+ - Expert level IELTS mastery"
        },
        intensive: {
            title: "Level Intensive",
            subtitle: "Elite Level - IELTS Conqueror",
            targetLabel: "For:",
            targetDescription: "Elite students with strong IELTS foundation (entry test score 6.5+) targeting band 7.0+ for universities or immigration.",
            goalLabel: "Requirements:",
            goalDescription: "Students must demonstrate advanced English proficiency and strategic thinking for high-stakes IELTS performance.",
            readingTitle: "ÔøΩ‚Äçüè´ Expert Coaching",
            readingDescription: "Master the most challenging academic materials, achieve consistent high performance under time pressure",
            speakingTitle: "ÔøΩ Mock Tests",
            speakingDescription: "Demonstrate native-like fluency with sophisticated vocabulary and natural discourse patterns",
            writingTitle: "üíª E-learning",
            writingDescription: "Produce publication-quality academic writing with advanced analytical and critical thinking skills",
            targetTitle: "üéØ Exam Ready",
            targetBand: "Band 7.0+ - IELTS Champion Level"
        }
    },
    vi: {
        candy: {
            title: "C·∫•p Candy",
            subtitle: "C·∫•p ƒê·ªô C∆° B·∫£n - N·ªÅn T·∫£ng IELTS",
            targetLabel: "D√†nh cho:",
            targetDescription: "Kh√¥ng d√†nh cho v·ª° l√≤ng, m·∫•t g·ªëc, m·∫•t cƒÉn b·∫£n. D√†nh cho nh·ªØng b·∫°n ch∆∞a l√†m quen v·ªõi IELTS, ch∆∞a ti·∫øp x√∫c nhi·ªÅu v·ªõi ti·∫øng Anh.",
            goalLabel: "M·ª•c ti√™u:",
            goalDescription: "ƒê·ªãnh h∆∞·ªõng, gi·ªõi thi·ªáu v·ªÅ IELTS. T·∫≠p trung √¥n l·∫°i m·ªôt s·ªë ch·ªß ƒëi·ªÉm ng·ªØ ph√°p ch√≠nh, b·ªï sung t·ª´ v·ª±ng c∆° b·∫£n theo ch·ªß ƒë·ªÅ, t·ª´ v·ª±ng v·ªÅ IELTS.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "L√†m quen c√°c b√†i ƒë∆°n gi·∫£n, ƒëo·∫°n vƒÉn ng·∫Øn, t·∫≠p ph√¢n t√≠ch, hi·ªÉu y√™u c·∫ßu ƒë·ªÅ b√†i",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "L√†m quen v·ªõi c√¢u h·ªèi ƒë∆°n gi·∫£n, t·∫≠p trung v√†o ph√°t tri·ªÉn √Ω, ph√°t √¢m v√† ph·∫£n x·∫°",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "T·∫≠p vi·∫øt c√¢u ho√†n ch·ªânh, t·∫≠p tri·ªÉn khai √Ω. Ph√¢n bi·ªát ƒë∆∞·ª£c vƒÉn n√≥i v√† vƒÉn vi·∫øt trong IELTS",
            targetTitle: "üéØ Target",
            targetBand: "Band 2.5 - N·ªÅn t·∫£ng v·ªØng ch·∫Øc cho c√°c level ti·∫øp theo"
        },
        cookies: {
            title: "C·∫•p Cookies",
            subtitle: "C·∫•p ƒê·ªô S∆° C·∫•p - Gi·ªõi Thi·ªáu IELTS",
            targetLabel: "D√†nh cho:",
            targetDescription: "Nh·ªØng b·∫°n ƒë√£ t·ª´ng h·ªçc IELTS d∆∞·ªõi 3 th√°ng (ƒëi·ªÉm test ƒë·∫ßu v√†o t·ª´ 3.0+) ho·∫∑c h·ªçc vi√™n ƒë√£ qua level Candy.",
            goalLabel: "M·ª•c ti√™u:",
            goalDescription: "C√°c b·∫°n b·∫Øt ƒë·∫ßu ti·∫øp x√∫c format IELTS, l√†m quen c√°c d·∫°ng b√†i ·ªü c√°c k·ªπ nƒÉng.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "L√†m c√°c d·∫°ng b√†i ng·∫Øn, t·∫≠p trung v√†o ph√¢n t√≠ch b√†i v√† n√¢ng c·∫•p t·ª´ v·ª±ng",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Luy·ªán n√≥i ch·ªß ƒë·ªÅ ƒë·ªùi s·ªëng quen thu·ªôc, t·∫≠p trung v√†o ph√°t tri·ªÉn √Ω theo format IELTS",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "L√†m quen v·ªõi l√Ω thuy·∫øt Vi·∫øt: bi·ªÉu ƒë·ªì Task 1 v√† c√°c d·∫°ng b√†i Task 2",
            targetTitle: "üéØ Target",
            targetBand: "Band 3.5 - Hi·ªÉu r√µ format v√† c√°ch l√†m b√†i IELTS"
        },
        donuts: {
            title: "C·∫•p Donuts",
            subtitle: "C·∫•p ƒê·ªô Trung C·∫•p - Ti·∫øn B·ªô IELTS",
            targetLabel: "D√†nh cho:",
            targetDescription: "Nh·ªØng b·∫°n ƒë√£ t·ª´ng h·ªçc IELTS (ƒëi·ªÉm test ƒë·∫ßu v√†o t·ª´ 4.0+) ho·∫∑c h·ªçc vi√™n ƒë√£ qua level Cookies.",
            goalLabel: "Y√™u c·∫ßu:",
            goalDescription: "C√°c b·∫°n ƒë√£ c√≥ ki·∫øn th·ª©c c∆° b·∫£n IELTS v√† c√°c d·∫°ng b√†i (level n√†y v·∫´n √¥n l·∫°i l√Ω thuy·∫øt Vi·∫øt).",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "B·∫Øt ƒë·∫ßu l√†m c√°c b√†i d√†i v√† th·ª≠ th√°ch h∆°n, ƒë·∫©y m·∫°nh k·ªπ nƒÉng ph√¢n t√≠ch b√†i",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Luy·ªán n√≥i ch·ªß ƒë·ªÅ quen thu·ªôc, tƒÉng c∆∞·ªùng ph√°t √¢m v√† ph·∫£n x·∫°, n√¢ng cao t·ª´ v·ª±ng B1&B2",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "Luy·ªán vi·∫øt c√°c d·∫°ng bi·ªÉu ƒë·ªì Task 1 v√† Task 2, ƒë·∫©y m·∫°nh k·ªπ nƒÉng ph√¢n t√≠ch v√† l·∫≠p d√†n √Ω",
            targetTitle: "üéØ Target",
            targetBand: "Band 4.5 - Th√†nh th·∫°o c√°c k·ªπ nƒÉng IELTS c∆° b·∫£n"
        },
        bagels: {
            title: "C·∫•p Bagels",
            subtitle: "C·∫•p ƒê·ªô Trung C·∫•p Cao - Th√†nh Th·∫°o IELTS",
            targetLabel: "D√†nh cho:",
            targetDescription: "Nh·ªØng b·∫°n ƒë√£ t·ª´ng h·ªçc IELTS (ƒëi·ªÉm test ƒë·∫ßu v√†o t·ª´ 4.5+) ho·∫∑c h·ªçc vi√™n ƒë√£ qua level Donuts.",
            goalLabel: "Y√™u c·∫ßu:",
            goalDescription: "C√°c b·∫°n ƒë√£ c√≥ n·ªÅn t·∫£ng v·ªÅ IELTS v√† mu·ªën n√¢ng cao k·ªπ nƒÉng ƒë·ªÉ ƒë·∫°t ƒëi·ªÉm cao h∆°n.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "L√†m quen v·ªõi c√°c b√†i ƒë·ªçc v√† nghe d√†i, ƒë·ªô kh√≥ tƒÉng d·∫ßn, ƒë·∫©y m·∫°nh t·ª´ v·ª±ng h·ªçc thu·∫≠t",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Luy·ªán t·∫≠p v·ªõi c√°c ch·ªß ƒë·ªÅ phong ph√∫, ph√°t tri·ªÉn √Ω logic, n√¢ng cao ph√°t √¢m",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "Luy·ªán vi·∫øt theo format chu·∫©n, ƒë·∫©y m·∫°nh k·ªπ nƒÉng l·∫≠p lu·∫≠n, s·ª≠ d·ª•ng t·ª´ v·ª±ng n√¢ng cao",
            targetTitle: "üéØ Target",
            targetBand: "Band 5.0+ - N√¢ng cao v√† tinh ch·ªânh c√°c k·ªπ nƒÉng IELTS"
        },
        burgers: {
            title: "C·∫•p Burgers",
            subtitle: "C·∫•p ƒê·ªô N√¢ng Cao - Xu·∫•t S·∫Øc IELTS",
            targetLabel: "D√†nh cho:",
            targetDescription: "Nh·ªØng b·∫°n ƒë√£ t·ª´ng h·ªçc IELTS (ƒëi·ªÉm test ƒë·∫ßu v√†o 5.0+) ho·∫∑c h·ªçc vi√™n ƒë√£ qua level Donuts.",
            goalLabel: "Y√™u c·∫ßu:",
            goalDescription: "C√°c b·∫°n ƒë√£ n·∫Øm ch·∫Øc ki·∫øn th·ª©c IELTS v√† k·ªπ nƒÉng l√†m b√†i c∆° b·∫£n ·ªü c√°c k·ªπ nƒÉng.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "L√†m c√°c b√†i ph·ª©c t·∫°p, n√¢ng cao t·ªëc ƒë·ªô v√† ƒë·ªô ch√≠nh x√°c trong t·∫•t c·∫£ d·∫°ng c√¢u h·ªèi",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "Luy·ªán t·∫≠p ch·ªß ƒë·ªÅ n√¢ng cao, ph√°t tri·ªÉn ƒë·ªô tr√¥i ch·∫£y v√† m·∫°ch l·∫°c, th√†nh th·∫°o ng·ªØ ph√°p ph·ª©c t·∫°p",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "Th√†nh th·∫°o k·ªπ thu·∫≠t vi·∫øt n√¢ng cao, t·ª´ v·ª±ng tinh t·∫ø v√† c·∫•u tr√∫c c√¢u ph·ª©c t·∫°p",
            targetTitle: "üéØ Target",
            targetBand: "Band 5.5+ - Tr√¨nh ƒë·ªô IELTS n√¢ng cao"
        },
        pizzas: {
            title: "C·∫•p Pizzas",
            subtitle: "C·∫•p ƒê·ªô Chuy√™n Gia - Th√†nh Th·∫°o IELTS",
            targetLabel: "D√†nh cho:",
            targetDescription: "Nh·ªØng b·∫°n ƒë√£ c√≥ n·ªÅn t·∫£ng v·ªØng ch·∫Øc v·ªÅ IELTS (ƒëi·ªÉm test ƒë·∫ßu v√†o t·ª´ 6.0+) ho·∫∑c h·ªçc vi√™n ƒë√£ qua level Burgers.",
            goalLabel: "Y√™u c·∫ßu:",
            goalDescription: "C√°c b·∫°n ƒë√£ c√≥ n·ªÅn t·∫£ng IELTS m·∫°nh m·∫Ω v√† mu·ªën ƒë·∫°t ƒëi·ªÉm cao cho m·ª•c ƒë√≠ch h·ªçc thu·∫≠t ho·∫∑c ngh·ªÅ nghi·ªáp.",
            readingTitle: "üìö Reading & Listening",
            readingDescription: "Th√†nh th·∫°o c√°c vƒÉn b·∫£n v√† b√†i nghe h·ªçc thu·∫≠t ph·ª©c t·∫°p, ƒë·∫°t m·ª©c hi·ªÉu bi·∫øt g·∫ßn nh∆∞ ng∆∞·ªùi b·∫£n ng·ªØ",
            speakingTitle: "üó£Ô∏è Speaking",
            speakingDescription: "ƒê·∫°t ƒë·ªô tr√¥i ch·∫£y nh∆∞ ng∆∞·ªùi b·∫£n ng·ªØ, th√†nh th·∫°o t·ª´ n·ªëi n√¢ng cao v√† t·ª´ v·ª±ng tinh t·∫ø",
            writingTitle: "‚úçÔ∏è Writing",
            writingDescription: "T·∫°o ra vƒÉn b·∫£n h·ªçc thu·∫≠t tinh t·∫ø v·ªõi l·∫≠p lu·∫≠n ph·ª©c t·∫°p v√† ƒë·∫∑c ƒëi·ªÉm ng√¥n ng·ªØ n√¢ng cao",
            targetTitle: "üéØ Target",
            targetBand: "Band 6.5+ - Th√†nh th·∫°o IELTS c·∫•p ƒë·ªô chuy√™n gia"
        },
        intensive: {
            title: "C·∫•p Chinh Ph·ª•c",
            subtitle: "C·∫•p ƒê·ªô Elite - Chinh Ph·ª•c IELTS",
            targetLabel: "D√†nh cho:",
            targetDescription: "H·ªçc vi√™n elite c√≥ n·ªÅn t·∫£ng IELTS m·∫°nh (ƒëi·ªÉm test ƒë·∫ßu v√†o 6.5+) nh·∫Øm m·ª•c ti√™u band 7.0+ cho ƒë·∫°i h·ªçc ho·∫∑c ƒë·ªãnh c∆∞.",
            goalLabel: "Y√™u c·∫ßu:",
            goalDescription: "H·ªçc vi√™n ph·∫£i th·ªÉ hi·ªán tr√¨nh ƒë·ªô ti·∫øng Anh n√¢ng cao v√† t∆∞ duy chi·∫øn l∆∞·ª£c cho hi·ªáu su·∫•t IELTS cao.",
            readingTitle: "ÔøΩ‚Äçüè´ Expert Coaching",
            readingDescription: "H·ªçc vi√™n ƒë∆∞·ª£c luy·ªán t·∫≠p v·ªõi ƒë·ªÅ thi th·∫≠t IELTS c√πng gi√°o vi√™n kinh nghi·ªám nhi·ªÅu nƒÉm",
            speakingTitle: "ÔøΩ Mock Tests",
            speakingDescription: "T·ªï ch·ª©c thi th·ª≠, ƒë∆∞a ra ƒë√°nh gi√° chi ti·∫øt ƒëi·ªÉm s·ªë cho 4 ti√™u ch√≠ c·ªßa IELTS",
            writingTitle: "üíª E-learning",
            writingDescription: "H·ªçc vi√™n ƒë∆∞·ª£c s·ª≠ d·ª•ng h·ªá th·ªëng E-learning c·ªßa STUDIO ƒë·ªÉ tr·∫£ b√†i t·∫≠p v·ªÅ nh√†",
            targetTitle: "üéØ Exam Ready",
            targetBand: "Chu·∫©n b·ªã t√¢m l√Ω tr∆∞·ªõc khi thi, luy·ªán t·∫≠p theo th·ªÉ th·ª©c thi th·ª±c t·∫ø"
        }
    }
};

// Course renderer class
class CourseRenderer {
    constructor() {
        this.templateCache = null;
        this.currentLanguage = localStorage.getItem('language') || 'en';
    }

    // Load course card template
    async loadTemplate() {
        if (this.templateCache) return this.templateCache;
        
        try {
            const response = await fetch('components/courses/course-card.html');
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            this.templateCache = await response.text();
            return this.templateCache;
        } catch (error) {
            console.error('Error loading course card template:', error);
            return null;
        }
    }

    // Create course card HTML directly instead of template replacement
    createCourseCard(courseId) {
        const course = courseData[courseId];
        const translation = courseTranslations[this.currentLanguage][courseId];
        
        if (!course || !translation) {
            console.error(`Course data not found for: ${courseId}`);
            return '';
        }

        // Determine styling classes
        const descSectionClass = course.isIntensive ? 'bg-white/10 backdrop-blur-sm' : 'bg-white';
        const skillSectionClass = course.isIntensive ? 'bg-white/10 backdrop-blur-sm' : 'bg-white';
        const textColorClass = course.isIntensive ? 'text-white/90' : 'text-gray-700';
        const skillTextColorClass = course.isIntensive ? 'text-white/80' : 'text-gray-600';

        return `
        <div class="course-card" data-course-id="${courseId}">
            <!-- Scroll anchor -->
            <div id="${courseId}-anchor" class="scroll-target"></div>
            
            <!-- Course card container -->
            <div id="${courseId}" class="course-container ${course.containerClasses} rounded-3xl p-8 shadow-lg hover:shadow-xl transition-all">
                <!-- Course header -->
                <div class="flex items-center mb-6">
                    <div class="course-icon-container w-16 h-16 ${course.iconBgClasses} rounded-2xl flex items-center justify-center mr-6">
                        <span class="course-icon text-white font-bold ${course.iconSize}">${course.icon}</span>
                    </div>
                    <div>
                        <h3 class="course-title text-3xl font-bold mb-2" style="color: #1D4B3B;">${translation.title}</h3>
                        <p class="course-subtitle ${course.isIntensive ? 'text-white/80' : 'text-gray-600'}">${translation.subtitle}</p>
                    </div>
                </div>
                
                <!-- Course description section -->
                <div class="${descSectionClass} rounded-2xl p-6 mb-6">
                    <h3 class="course-target-label font-semibold text-lg mb-3 ${course.skillColorClass}">${translation.targetLabel}</h3>
                    <p class="course-target-description ${textColorClass} mb-4">${translation.targetDescription}</p>
                    <h3 class="course-goal-label font-semibold text-lg mb-3 ${course.skillColorClass}">${translation.goalLabel}</h3>
                    <p class="course-goal-description ${textColorClass}">${translation.goalDescription}</p>
                </div>
                
                <!-- Course skills grid -->
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="${skillSectionClass} rounded-xl p-4">
                        <h4 class="course-reading-title font-semibold ${course.skillColorClass} mb-2">${translation.readingTitle}</h4>
                        <p class="course-reading-description text-sm ${skillTextColorClass}">${translation.readingDescription}</p>
                    </div>
                    <div class="${skillSectionClass} rounded-xl p-4">
                        <h4 class="course-speaking-title font-semibold ${course.skillColorClass} mb-2">${translation.speakingTitle}</h4>
                        <p class="course-speaking-description text-sm ${skillTextColorClass}">${translation.speakingDescription}</p>
                    </div>
                    <div class="${skillSectionClass} rounded-xl p-4">
                        <h4 class="course-writing-title font-semibold ${course.skillColorClass} mb-2">${translation.writingTitle}</h4>
                        <p class="course-writing-description text-sm ${skillTextColorClass}">${translation.writingDescription}</p>
                    </div>
                    <div class="${skillSectionClass} rounded-xl p-4">
                        <h4 class="course-target-title font-semibold ${course.skillColorClass} mb-2">${translation.targetTitle}</h4>
                        <p class="course-target-band text-sm ${skillTextColorClass}">${translation.targetBand}</p>
                    </div>
                </div>
            </div>
        </div>`;
    }

    // Render all courses
    async renderAllCourses() {
        const courseOrder = ['candy', 'cookies', 'donuts', 'bagels', 'burgers', 'pizzas', 'intensive'];
        let allCoursesHTML = '';
        
        for (const courseId of courseOrder) {
            allCoursesHTML += this.createCourseCard(courseId) + '\n\n';
        }
        
        return allCoursesHTML;
    }

    // Update language for all courses
    async updateLanguage(newLanguage) {
        this.currentLanguage = newLanguage;
        const container = document.getElementById('courses-container');
        if (container) {
            const coursesHTML = await this.renderAllCourses();
            container.innerHTML = coursesHTML;
        }
    }
}

// Global course renderer instance
let courseRenderer = null;

// Load courses function
async function loadCourses() {
    try {
        if (!courseRenderer) {
            courseRenderer = new CourseRenderer();
        }
        
        const container = document.getElementById('courses-container');
        if (container) {
            const coursesHTML = await courseRenderer.renderAllCourses();
            container.innerHTML = coursesHTML;
            
            // Dispatch event to notify other components that courses are loaded
            document.dispatchEvent(new CustomEvent('coursesLoaded'));
        } else {
            console.error('Courses container not found');
        }
    } catch (error) {
        console.error('Error loading courses:', error);
    }
}

// Update courses language
async function updateCoursesLanguage(language) {
    if (courseRenderer) {
        await courseRenderer.updateLanguage(language);
    }
}

// Listen for language changes
document.addEventListener('languageChanged', function(event) {
    const newLanguage = event.detail.language;
    updateCoursesLanguage(newLanguage);
});

// Auto-load courses when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    loadCourses();
});

// Export functions for manual loading if needed
if (typeof window !== 'undefined') {
    window.loadCourses = loadCourses;
    window.updateCoursesLanguage = updateCoursesLanguage;
    window.CourseRenderer = CourseRenderer;
}